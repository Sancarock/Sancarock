<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>R√°dio Sancarock - Dados M√≥veis</title>
<style>
body, html {
  margin: 0;
  padding: 0;
  background: transparent !important;
}

#playerContainer {
  display: flex;
  align-items: center;
  gap: 50px;
  background: transparent !important;
  padding: 2px;
  margin: 0;
  border-radius: 0;
  color: #fff;
  font-family: Arial, sans-serif;
  font-size: 12px;
  box-shadow: 0 0 20px rgba(255,0,0,0.4);
}
.album-cover {
  width: 80px;
  height: 80px;
  border-radius: 5px;
}

.track-info {
  display: flex;
  flex-direction: column;
  justify-content: center;
  min-width: 120px;
}

.equalizer {
  display: flex;
  align-items: flex-end;
  gap: 2px;
}

.equalizer span {
  width: 4px;
  height: 12px;
  background-color: yellow;
  animation: bounce 0.6s infinite ease-in-out;
}

@keyframes bounce {
  0%,100% { height: 12px; }
  50% { height: 24px; }
}

.player-button {
  background-color: #800000;
  border: none;
  color: #fff;
  padding: 5px 7px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
}

.player-button:hover { background-color: #444; }

#volumeDisplay { min-width: 30px; text-align: center; }

audio {
  display: none;
}

#noticias {
  font-family: 'Arial Black', sans-serif; /* Fonte */
  font-size: 20px;                        /* Tamanho */
  color: #ffcc00;                          /* Cor */
  text-align: center;                      /* Centralizado */
  transition: opacity 0.5s;                /* Fade */
}
</style>
</head>
<body>

<div id="playerContainer">
  <img id="albumCover" src="img/tocar.png" alt="Capa do √Ålbum" class="album-cover">

  <div class="track-info">
    <p id="trackTitle">R√°dio Sanca Rock</p>
    <p id="artistName"></p>
  </div>

  <button id="playPause" class="player-button">&#9654;</button>
  <button id="atualizar" class="player-button" type="button" onClick="history.go(0)">‚Üª</button>
  <button id="volMinus" class="player-button">-</button>
  <span id="volumeDisplay">50%</span>
  <button id="volPlus" class="player-button">+</button>

  <div class="equalizer" id="equalizer" style="display: none;">
    <span></span><span></span><span></span><span></span><span></span>
  </div>
  <div class="marquee">
    <span id="noticias">Carregando not√≠cias...</span>
  </div>


</div>




<audio id="radioPlayer" src="https://s02.transmissaodigital.com:6716/stream;" preload="auto"></audio>

<script src="js/topao.js?v=6"></script>
<script>
 const feeds = [
  'https://www.noticiasaominuto.com.br/rss/esporte',
  'https://www.noticiasaominuto.com.br/rss/cultura',
  'https://www.noticiasaominuto.com.br/rss/fama',
  'https://www.noticiasaominuto.com.br/rss/ultima-hora',
  'https://www.noticiasaominuto.com.br/rss/politica',
  'https://www.noticiasaominuto.com.br/rss/economia',
  'https://www.noticiasaominuto.com.br/rss/justica',
  'https://www.noticiasaominuto.com.br/rss/tech',
  'https://www.noticiasaominuto.com.br/rss/lifestyle',
  'https://www.noticiasaominuto.com.br/rss/mundo'
];

// Slogan
const slogan = { titulo: "ü§ò Programa Monstros do Rock - Especial Rainbow, S√°bado √†s 20h ü§ò", url: null };

// Patrocinadores
const patrocinadores = [
  { titulo: "VJ Suplementos, a melhor loja de Suplementos de S√£o Carlos", url: "https://www.instagram.com/vjsuplementos_saocarlos/" },
  { titulo: "JM Bebidas - A sua Melhor op√ß√£o em Bebidas", url: "https://www.instagram.com/jm.bebidass23/" },
  { titulo: "Siga nosso Instagram - @radio_sancarock/", url: "https://www.instagram.com/radio_sancarock/" }
];

let todasNoticias = [];
const noticiasSpan = document.getElementById('noticias');

// Normaliza HTML entities e caracteres especiais
function normalizeText(text) {
  const txt = document.createElement('textarea');
  txt.innerHTML = text;
  return txt.value.normalize('NFC').trim();
}

// Busca RSS
async function fetchRSS(url) {
  try {
    const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`);
    const data = await response.json();
    if (data.items) {
      return data.items.map(item => ({
        titulo: normalizeText(item.title),
        url: item.link
      }));
    }
    return [];
  } catch (error) {
    console.warn(`Feed ${url} falhou, ignorando...`);
    return [];
  }
}

// Embaralhar array
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// Carrega not√≠cias, patrocinadores e intercala slogan
async function carregarNoticias() {
  const resultados = await Promise.allSettled(feeds.map(feed => fetchRSS(feed)));

  let noticiasRSS = [];
  resultados.forEach(r => {
    if (r.status === 'fulfilled' && r.value.length > 0) {
      r.value.forEach(n => {
        if (!noticiasRSS.some(x => x.titulo === n.titulo)) noticiasRSS.push(n);
      });
    }
  });

  noticiasRSS = shuffleArray(noticiasRSS);
  if (noticiasRSS.length === 0) noticiasRSS.push({ titulo: "Nenhuma not√≠cia dispon√≠vel", url: null });

  // Monta array intercalando: a cada 3 mensagens, insere o slogan
  todasNoticias = [];
  let noticiaIndex = 0;
  let patrocinadorIndex = 0;

  while (noticiaIndex < noticiasRSS.length || patrocinadorIndex < patrocinadores.length) {
    // A cada 3 mensagens, coloca o slogan
    if (todasNoticias.length % 4 === 0) {
      todasNoticias.push(slogan);
    }

    // Intercala not√≠cias
    if (noticiaIndex < noticiasRSS.length) {
      todasNoticias.push(noticiasRSS[noticiaIndex]);
      noticiaIndex++;
    }

    // Intercala patrocinadores
    if (patrocinadorIndex < patrocinadores.length) {
      todasNoticias.push(patrocinadores[patrocinadorIndex]);
      patrocinadorIndex++;
    }
  }

  mostrarMensagem(0);
}

// Mostra cada mensagem com fade
function mostrarMensagem(index) {
  noticiasSpan.style.opacity = 0;

  setTimeout(() => {
    const mensagemAtual = todasNoticias[index];
    if (mensagemAtual.url) {
      noticiasSpan.innerHTML = `<a href="${mensagemAtual.url}" target="_blank" style="color:#ffcc00; text-decoration:none;">${mensagemAtual.titulo}</a>`;
    } else {
      noticiasSpan.innerHTML = mensagemAtual.titulo;
    }
    noticiasSpan.style.transition = 'opacity 0.5s';
    noticiasSpan.style.opacity = 1;
  }, 500);

  const duration = Math.max(2, todasNoticias[index].titulo.length * 0.15) * 1000;

  setTimeout(() => {
    mostrarMensagem((index + 1) % todasNoticias.length);
  }, duration + 500);
}

// Inicia o letreiro
carregarNoticias();

// Atualiza os RSS a cada 5 minutos
setInterval(() => {
  carregarNoticias();
}, 300000);











  </script>
</body>

</html>
