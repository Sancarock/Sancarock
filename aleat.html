<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>üé∏ Player YouTube Personalizado</title>
<style>
  body {
    background-color: #191919
    color: #fff;
    text-align: center;
    font-family: Arial, sans-serif;
  }

  #videoTitle {
    font-size: 20px;
    margin-top: 20px;
    font-weight: bold;
    color: #ff4444;
  }

  /* Centraliza e mant√©m o v√≠deo responsivo */
  .video-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 30px auto;
    width: 100%;
    max-width: 800px;  /* antes era 560px */
    aspect-ratio: 16 / 9;
    background: #111;
    border-radius: 10px;
    overflow: hidden;
}

 iframe {
    width: 100%;
    height: 100%;
    border: none;
}

  .controls {
  display: flex;
  flex-wrap: wrap;       /* permite quebrar linha em telas pequenas */
  justify-content: center;
  gap: 8px;              /* espa√ßo entre os bot√µes */
  margin-top: 10px;
}

  button {
  background: #c00;
  color: #fff;
  border: none;
  padding: 8px 14px; /* menor padding */
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
}

/* Ajuste espec√≠fico para telas pequenas (mobile) */
@media (max-width: 480px) {
  .controls button {
    padding: 6px 10px;  /* bot√µes menores no celular */
    font-size: 12px;    /* fonte menor */
    flex: 1 1 100px;    /* largura m√≠nima menor para caber melhor */
  }
}

  button:hover {
    background: #f33;
  }
</style>
</head>
<body>

<div id="videoTitle" style="text-align:center; color:#ff4444; font-weight:bold; margin-bottom:10px;">
  Carregando t√≠tulo...
</div>

<div id="container" class="video-container">
    <div id="player"></div>
</div>

<div class="controls" style="text-align:center; margin-top:10px;">
    <button onclick="nextVideo()">Pr√≥ximo ‚ñ∂</button>
    <button onclick="playRandomVideo()">üîÑ Aleat√≥rio</button>
    <button onclick="window.open('https://www.youtube.com/@R√°dioSancaRock', '_blank')">Nosso Canal</button>
  <p><a href="https://brave.com/pt/download/" target="_blank"><img src="img/brave.png" alt="brave" width="284" height="27" border="0"></a></p>
</div>

<script src="https://www.youtube.com/iframe_api"></script>

<script>
let player;
const PLAYLIST_ID = 'PLYXfLV3z1Kzysf0c-wpY6qDuKyj5KHGno';
const titleEl = document.getElementById('videoTitle');

function onYouTubeIframeAPIReady() {
  player = new YT.Player('player', {
    width: '100%',
    height: '100%',
    playerVars: {
      listType: 'playlist',
      list: PLAYLIST_ID,
      rel: 0,
      modestbranding: 1,
      autoplay: 1,
      mute: 0,
      controls: 1
    },
    events: {
      onReady: onPlayerReady,
      onStateChange: onPlayerStateChange
    }
  });
}

function onPlayerReady(event) {
  // toca v√≠deo aleat√≥rio no in√≠cio
  setTimeout(() => {
    const playlist = player.getPlaylist();
    if (playlist && playlist.length > 0) {
      const randomIndex = Math.floor(Math.random() * playlist.length);
      player.playVideoAt(randomIndex);
    } else {
      setTimeout(() => { player.playVideo(); }, 1000);
    }
  }, 800);

  updateTitleRepeatedly();
}

function onPlayerStateChange(event) {
  if(event.data === YT.PlayerState.PLAYING){
    updateTitleRepeatedly();
  }
}

function updateTitleRepeatedly() {
  let attempts = 0;
  const interval = setInterval(() => {
    if(player){
      const videoData = player.getVideoData();
      if(videoData && videoData.title){
        let cleanTitle = videoData.title;

        // Remove tudo entre par√™nteses
        cleanTitle = cleanTitle.replace(/\s*\(.*?\)\s*/g, '');
        // Remove tudo entre colchetes
        cleanTitle = cleanTitle.replace(/\s*\[.*?\]\s*/g, '');
        // Remove emojis e caracteres especiais
        cleanTitle = cleanTitle.replace(/[\u{1F300}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/gu, '');
        // Remove espa√ßos extras no in√≠cio/fim
        cleanTitle = cleanTitle.trim();

        titleEl.textContent = cleanTitle;
        clearInterval(interval);
      } else if(attempts++ > 20){
        titleEl.textContent = "T√≠tulo n√£o dispon√≠vel";
        clearInterval(interval);
      }
    }
  }, 300);
}


function playRandomVideo() {
  const playlist = player.getPlaylist();
  if(playlist && playlist.length > 0){
    const randomIndex = Math.floor(Math.random() * playlist.length);
    player.playVideoAt(randomIndex);
    updateTitleRepeatedly();
  } else {
    setTimeout(playRandomVideo, 500);
  }
}

function nextVideo() {
  if(player) player.nextVideo();
  updateTitleRepeatedly();
}

function toggleFullscreen() {
  const container = document.getElementById('container');
  if(!document.fullscreenElement){
    if(container.requestFullscreen) container.requestFullscreen();
    else if(container.webkitRequestFullscreen) container.webkitRequestFullscreen();
    else alert("Gire seu celular para paisagem!");
  } else {
    if(document.exitFullscreen) document.exitFullscreen();
    else if(document.webkitExitFullscreen) document.webkitExitFullscreen();
  }
}
</script>

</body>
</html>
